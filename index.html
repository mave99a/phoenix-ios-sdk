<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Phoenix iOS SDK by phoenixplatform</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>Phoenix iOS SDK</h1>
        <h2>TSPhoenix</h2>
        <a href="https://github.com/phoenixplatform/phoenix-ios-sdk" class="button"><small>View project on</small>GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h2>
<a name="overview" class="anchor" href="#overview"><span class="octicon octicon-link"></span></a>Overview</h2>

<p>Tigerspike Phoenix SDK (TSPhoenix) is an iOS SDK for <a href="http://developers.phoenixplatform.com/GettingStarted">Tigerspike Phoenix Platform</a>. By using the SDK instead of the HTTP APIs, you can save massive amount of development time, interface with objective-level APIs and focus your time and energy on the UI.</p>

<ul>
<li>Native Objective-C APIs</li>
<li>Native Objective-C models, with 100% coverage of Phoenix server side models</li>
<li>Seamless integration with Cocoapods</li>
<li>Lightweight: TSPhoenix is a very thin layer built-on top of AFNetworking</li>
<li>OAuth2: log in, out, auth tokens, etc.</li>
</ul><h2>
<a name="design-goals" class="anchor" href="#design-goals"><span class="octicon octicon-link"></span></a>Design goals</h2>

<ul>
<li>Plug and play</li>
<li>Allow developers to work with familiar Objective-C APIs, without having to worry about modeling / networking / caching</li>
<li>Leverage best OSS libraries. Don't reinvent the wheel</li>
<li>Significantly reduce the amount of glue code when working with Phoenix API</li>
<li>Things that will be done over and over again should be automated</li>
</ul><h2>
<a name="architecture" class="anchor" href="#architecture"><span class="octicon octicon-link"></span></a>Architecture</h2>

<p>TSPhoenix is a thin layer built on top of the networking and database layer. It includes <strong>all</strong> Phoenix data type models. It also includes a few helpers to make it easy to work with Phoenix APIs.</p>

<p>TSPhoenixClient is the Singleton entry point to SDK. It is a standard AFHTTPClient subclass. It also owns all Phoenix modules (identity, media, syndicate, messaging, analytics).</p>

<p><img src="https://raw2.github.com/phoenixplatform/phoenix-ios-sdk/develop/images/architecture.png" alt="Architecture"></p>

<h2>
<a name="work-in-progress" class="anchor" href="#work-in-progress"><span class="octicon octicon-link"></span></a>Work in progress</h2>

<p>Tigerspike Phoenix SDK (TSPhoenix) for iOS is actively being developed. </p>

<p>TSPhoenix is already powering Fuse which is a newsreader app. By using the SDK, Fuse developer only need to worry about how to deliver the UI. Modelling, caching and networking are all taken care of by TSPhoenix.</p>

<h2>
<a name="status" class="anchor" href="#status"><span class="octicon octicon-link"></span></a>Status</h2>

<ul>
<li>Installation: only Cocoapod supported at the moment</li>
<li>Model generation: 100% working</li>
<li>Model mapping JSON -&gt; Objective-C: 100% working</li>
<li>All contributions are welcome! Please use the "Issues" page to submit feedback.</li>
<li>Or fork and submit Pull Requests</li>
<li>First alpha release</li>
<li>Documentation is being baked</li>
<li>Unit Testing is on the TODO list</li>
</ul><h2>
<a name="for-the-curious-who-wants-to-read-some-code" class="anchor" href="#for-the-curious-who-wants-to-read-some-code"><span class="octicon octicon-link"></span></a>For the curious who wants to read some code</h2>

<p>If you are interested in reading some Objective-C code, look into Source/ and Models/</p>

<p>If you are interested in how the models are automatically generated, look at Generators/</p>

<h2>
<a name="dependencies" class="anchor" href="#dependencies"><span class="octicon octicon-link"></span></a>Dependencies</h2>

<p>Why, you ask? Why have dependencies in a SDK library?</p>

<p>The reason is simple: don't re-invent the wheel. Everybody is already using AFNetworking for HTTP requests. YapDatabase is a solid key-value DB built on SQLite. If we roll our own networking and database, it will consume a ton of effort, and the result is not necessarily better. By leveraging the best open source components, </p>

<p><a href="https://github.com/AFNetworking/AFNetworking/tree/1.x">AFNetworking</a>, ~&gt;1.3.3 (using 1.3.x to maintain iOS 6 compatibility)</p>

<p><a href="https://github.com/yaptv/YapDatabase">YapDatabase</a> ~&gt; 2.3 Database (caching) layer in Phoenix SDK.</p>

<h2>
<a name="full-documentation-is-coming-soon-here-are-some-examples-to-get-you-started" class="anchor" href="#full-documentation-is-coming-soon-here-are-some-examples-to-get-you-started"><span class="octicon octicon-link"></span></a>Full documentation is coming soon. Here are some examples to get you started:</h2>

<h3>
<a name="setting-up" class="anchor" href="#setting-up"><span class="octicon octicon-link"></span></a>Setting up</h3>

<p>In - applicationDidFinishLaunching:</p>

<pre><code>[TSPhoenixClient setUpWithBaseURL:[NSURL URLWithString:@"https://api.phoenixplatform.com.sg/"]
                         clientID:@"client_ID"
                     clientSecret:@"top_secret"
                        projectID:123];
</code></pre>

<p>Because Phoenix has been deployed across many regions (and more coming), we make the baseURL configurable to allow TSPhoenix to point to any region (.sg, .uk, ...) and any environment (dev, hat, live).</p>

<h3>
<a name="authenticating-user" class="anchor" href="#authenticating-user"><span class="octicon octicon-link"></span></a>Authenticating user</h3>

<pre><code>[[TSPhoenixClient identity] authenticateWithUsername:self.userField.text
                                            password:self.passwordField.text
                                             success:^(AFOAuthCredential *credential) {
                                                 // Token is automatically saved to keychain
                                                 // It's also auto restored between app launches
                                             } failure:^(NSError *error) {
                                                 // Handle error
                                             }];
</code></pre>

<h3>
<a name="getting-the-current-users-profile" class="anchor" href="#getting-the-current-users-profile"><span class="octicon octicon-link"></span></a>Getting the current user's profile</h3>

<pre><code>NSString *path = @"identity/v1/users/me";
[[TSPhoenixClient sharedInstance] getPath:path
                               parameters:nil
                                  success:^(AFHTTPRequestOperation *operation, id responseObject) {
                                      NSDictionary *dict = [(AFJSONRequestOperation *)operation responseJSON];
                                      dict = dict[@"Data"][0];
                                      TSUser *user = [[TSUser alloc] initWithDictionary:dict];

                                      // Do something about the user

                                  } failure:^(AFHTTPRequestOperation *operation, NSError *error) {
                                      // Handle error
                                  }];
</code></pre>

<h3>
<a name="getting-a-list-of-subscribed-sections-in-syndicate" class="anchor" href="#getting-a-list-of-subscribed-sections-in-syndicate"><span class="octicon octicon-link"></span></a>Getting a list of subscribed sections in Syndicate</h3>

<pre><code>NSString *path = [NSString stringWithFormat:@"syndicate/v1/projects/%d/sections",
                  [[TSPhoenixClient sharedInstance] projectID];

NSArray *parameters = @[[TSPhoenixParameter pageNumberTemplateParameter],
                        [TSPhoenixParameter pageSizeTemplateParameter],
                        [TSPhoenixParameter sortByRankParameter],
                        [TSPhoenixParameter sortDirectionAscendingParameter],
                        [TSPhoenixParameter parameterWithName:@"subscribedonly"
                                                        value:@"true"]];

NSString *parameterString = [TSPhoenixParameter parameterStringFromParameters:parameters];
NSString *pattern = [path stringByAppendingString:parameterString];
TSPaginator *paginator = [[TSPaginator alloc] initWithRequestPatternPath:pattern
                                                              httpClient:self.client];

[self.client.paginators addObject:paginator];

paginator.dataArrayKeyPath = @"Data";
paginator.objectCountKeyPathInResponse = @"TotalRecords";
paginator.zeroIndexed = YES;
paginator.perPage = kPhoenixResponsePageSize;
[paginator setObjectMappingBlock:^NSArray *(NSArray *sourceObjects) {
    __block NSArray *destinationObjects;
    destinationObjects = [sourceObjects mapObjectsUsingBlock:^id(id obj, NSUInteger idx) {
        return [[TSSection alloc] initWithDictionary:obj];
    }];
    return destinationObjects;
}];

__weak typeof(self) refToSelf = self;

[paginator setCompletionBlockWithSuccess:^(TSPaginator *paginator, NSArray *objects, NSUInteger page) {
            // Do something about the result objects
            // e.g. save to database
    [self.client saveObjectsToDatabase:objects];
} failure:^(TSPaginator *paginator, NSError *error) {
    // Handle error
}];
</code></pre>

<h2>
<a name="modules" class="anchor" href="#modules"><span class="octicon octicon-link"></span></a>Modules</h2>

<h3>
<a name="tsphoenixclient" class="anchor" href="#tsphoenixclient"><span class="octicon octicon-link"></span></a>TSPhoenixClient</h3>

<p>A <strong>singleton</strong> entry to all SDK modules. It is a standard AFHTTPClient subclass which handles all the underlying network traffic.
    [TSPhoenixClient sharedInstance]</p>

<p>all modules are a property of the shared instance, i.e.
    [TSPhoenixClient sharedInstance].identity
    [TSPhoenixClient sharedInstance].syndicate</p>

<h3>
<a name="tsphoenixidentity" class="anchor" href="#tsphoenixidentity"><span class="octicon octicon-link"></span></a>TSPhoenixIdentity</h3>

<p>Phoenix Identity module, responsible for OAuth logging in / out, loading memberships, etc.</p>

<h3>
<a name="tsphoenixsyndicate" class="anchor" href="#tsphoenixsyndicate"><span class="octicon octicon-link"></span></a>TSPhoenixSyndicate</h3>

<p>Phoenix Syndicate module, responsible for loading and caching sections / articles, sending article interactions back to Phoenix.</p>

<h2>
<a name="installation" class="anchor" href="#installation"><span class="octicon octicon-link"></span></a>Installation</h2>

<p>Please read the <a href="http://developers.phoenixplatform.com/GettingStarted">Phoenix Getting Started Guide</a> to get a basic understanding of Phoenix APIs.</p>

<p>To integrate the SDK:</p>

<pre><code>pod 'TSPhoenix', :git =&gt; 'https://github.com/phoenixplatform/phoenix-ios-sdk.git', :branch =&gt; 'develop'
</code></pre>

<p>and then in Prefix.pch:</p>

<pre><code>#import &lt;TSPhoenix/TSPhoenix.h&gt;
</code></pre>

<p>in AppDelegate.m -appDidFinishLaunching:</p>

<pre><code>[TSPhoenixClient setUpWithClientID:…]
</code></pre>

<h2>
<a name="database-yapdatabase" class="anchor" href="#database-yapdatabase"><span class="octicon octicon-link"></span></a>Database: <a href="https://github.com/yaptv/YapDatabase">YapDatabase</a>
</h2>

<p>TSPhoenix provides out-of-the-box integration with YapDatabase. All model objects conform to NSCoding, meaning you can use TSPhoenix with other databases of your choice.</p>

<p>Why did we choose YapDatabase, not Core Data / FMDB / SQLite / ...</p>

<p>The criteria when choosing the database for TSPhoenix are:</p>

<ul>
<li>Robust. Ideally, the database requires <strong>no</strong> maintenance</li>
<li>Flexibility. The DB should not break or complain if server-side model changes</li>
<li>Straightforward. Work at the objects level, not DB table.</li>
<li>Flexible &amp; extensible</li>
</ul><p>We evaluated many options, including Core Data and plain SQLite, among many others. </p>

<p>Core Data doesn't work, because a). it enforces a strict schema, which requires migration between versions. b). there is no way to automatically generate .xcdatamodel from server models.  </p>

<p>Plain SQLite is very low level. We don't want people to learn SQL before they can use TSPheonix. They should be talking Cocoa (NSObjects), not tables, queries, etc.</p>

<p>From YapDatabase wiki:</p>

<blockquote>
<p>YapDatabase is a comprised of 2 main features:</p>

<ul>
<li>a collection/key/value store built atop sqlite for iOS &amp; Mac (the foundation)</li>
<li>a plugin architecture that provides for advanced functionality such as Views, Secondary Indexes, Full Text Search, etc.</li>
</ul>
</blockquote>

<p>This <a href="https://github.com/yaptv/YapDatabase/wiki/Why-did-we-create-YapDatabase">page</a> sums it up perfectly on why we need a key-value database for TSPhoenix.</p>

<p>In the past few months, we put YapDatabase under stress, went though many version upgrades, changed the model multiple times. YapDB handled everything without breaking a sweat.</p>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/phoenixplatform/phoenix-ios-sdk/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/phoenixplatform/phoenix-ios-sdk/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/phoenixplatform/phoenix-ios-sdk"></a> is maintained by <a href="https://github.com/phoenixplatform">phoenixplatform</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>